-- 获取杭州的所有栅格
create table temp_hangzhou_grid as
select a.id, a.grid_lat_cent, a.grid_lng_cent, a.lng_join, a.lat_join, b.city_name, b.county_name from dwfu_hive_db.I_CDM_BD09_GRID a
join (
    select * from dwfu_hive_db.I_CDM_GRID2COMMUNITY
    where p_day = '20220625' and city_name = '杭州市'
    ) b
on a.id = b.id

create table temp_binjiang_grid_20220701 as
select * from temp_hangzhou_grid where ptpmd(cast(grid_lng_cent) as double, cast(grid_lat_cent) as double, '120.14171790317269,30.162036453899248;120.1372623078432,30.1693429582578;120.13525010350084,30.1775855371841;120.13632807011281,30.19138405337394;120.14804197396293,30.19681551280645;120.17319452824232,30.20037389109825;120.19676606482413,30.212858401228146;120.21516336166849,30.221971083397758;120.22558370558423,30.232643072085086;120.2389504915727,30.223656212017506;120.24125015367824,30.21778934196275;120.24132201811904,30.20293334602658;120.23995659374387,30.18832482231582;120.24096269591504,30.174151213927534;120.23003930091372,30.160662520187334;120.18778300972436,30.12187214315934;120.17887181906538,30.128119621067498;120.16902639067601,30.137177754745117;120.15989960669464,30.143861494262165;120.15429418031238,30.148483626057015;120.14883248281171,30.153043082275836') <> -1